{#配置项测试  echarts编辑器 #}
{% extends 'base.html' %}


{% block container %}

{#    测试图表#}
    <div id="chart" style="width: 400px;height: 400px;">
    </div>


<a  href="#!"  class="button waves-red" onclick="openConfig()">打开配置</a>

 <div class="input-field ">
          <input id="password" type="text" class="validate">
          <label for="password">输入框测试</label>
        </div>

{#    嵌套测试 #}
    <ul class="collapsible">

    <li>
        <div class="collapsible-header">二级展开</div>
        <div class="collapsible-body">
            <ul class="collapsible">
                <li> <div class="collapsible-header">二级展开</div>
        <div class="collapsible-body">
            <ul class="collapsible">
                <li>三级</li>
                <li>T三级</li>
            </ul>
        </div></li>
                <li>Test2</li>
            </ul>
        </div>
    </li>

    </ul>



{#    应用按钮 ,默认隐藏 #}
    <a href="#!"  id='apply' class="btn waves-block hide" style="z-index: 99999;position:fixed;top:0;right: 0;" >应用</a>
    <div class="sidenav" style="width: 500px" id="slide">

        <h4>图表配置</h4>


            {# 配置项 #}
    <div  class="container" id="option"></div>
    </div>


{% endblock %}





{% block script %}


     <script type="text/javascript" src="{{ url_for('static',filename='js/echarts.js') }}"></script>
     <script type="text/javascript" src="{{ url_for('static',filename='chart/chartEditor.js') }}"></script>

    <script type="text/javascript">


    var chartEditor = new ChartEditor();



        //生成侧滑的配置
        function openConfig() {

            slide.open();

            //var chart = echarts.getInstanceByDom(document.getElementById('chart'));

            console.log("图表配置:");
            console.log(chart.getOption());

            {# 存放配置的容器#}
            var container = document.getElementById('option');

            //$(container).empty();

            //填充菜单到容器
            //optionMenu(chart.getOption(),container,'',0);

            console.log("初始化..");

            //初始化伸展菜单
           // M.Collapsible.init(document.querySelectorAll('.collapsible'));

            chartEditor.setChartId('chart');
            chartEditor.generateConfig(container);

    }






    {#生成测试图表#}
    var chart = echarts.init(document.getElementById('chart'));

    var options = {
        title:{
            text:"测试图表"
        },
        series:{
            type:'pie',
            data:[
                {name:"Android",value:40},
                {name:"Linux",value:30},
                {name:"Windows",value:3}
            ]
        }
    };

    chart.setOption(options);


    var slide;
    {#初始化侧滑栏#}
    document.addEventListener('DOMContentLoaded',function (evt) {
        slide=M.Sidenav.init(document.getElementById('slide'),{
         preventScrolling:false,
        //关闭时
        edge:'right',
            onOpenEnd:function(){
             $('#apply').removeClass('hide');
            },
        onCloseEnd:function () {
            $("#apply").addClass('hide');


            chartEditor.updateChart();

        }
    });


    });

    //提交按钮
    $('#apply').click(function () {
        chartEditor.updateChart();

    })


    </script>

{% endblock %}